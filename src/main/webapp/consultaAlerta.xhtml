<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets">

<h:head>
	<f:metadata>
		<f:viewAction action="#{loginBean.isLoggedForward()}" />
	</f:metadata>
</h:head>
<ui:composition template="main.xhtml">
	<ui:define name="title">Mapa de Alertas</ui:define>
	<ui:define name="body">
		<script src="https://maps.googleapis.com/maps/api/js?sensor=false" />
		<h:form>
			<div class="col-md-12" style="margin-top: 5%; padding-bottom: 10%;">
				<p:gmap center="-15.7880217,-47.8390782" zoom="12" type="MAP"
					id="mapaAlerta" style="width:98%;height:450px"
					model="#{mapBean.emptyModel}"
					onPointClick="handlePointClick(event);">
					<p:ajax event="overlaySelect" listener="#{mapBean.onMarkerSelect}" />

					<p:gmapInfoWindow id="infoWindow">
						<p:outputPanel
							style="text-align: center; display: block; margin: auto">
							<h:outputText value="#{mapBean.marker.title}" />
						</p:outputPanel>
					</p:gmapInfoWindow>
				</p:gmap>
			</div>
			<p:outputPanel rendered="#{listFactory.listaAlerta.size() &lt; 1}">
				<div class="col-md-12" style="margin-top: -10%;">
					<h2>Nenhuma alerta cadastrada.</h2>
				</div>
			</p:outputPanel>

			<p:outputPanel id="tabelaAlertas"
				rendered="#{listFactory.listaAlerta.size() &gt; 0}">
				<div class="col-md-12">
					<table class="table table-hover table-striped">
						<thead>
							<tr>
								<th style="width: 25%">Título</th>
								<th style="width: 55%">Latitude , Longitude</th>
								<th style="width: 15%;">Operações</th>
							</tr>
						</thead>
						<tbody>
							<ui:repeat var="alerta" value="#{listFactory.listaAlerta}">
								<tr>
									<td style="width: 25%">#{alerta.titulo}</td>
									<td style="width: 55%">#{alerta.latitude} ,
										#{alerta.longitude}</td>
									<td style="width: 15%;">
										<div style="margin-left: 10%;">
											<h:commandLink
												action="#{consultarAlerta.excluirAlerta(alerta)}">
												<i class="glyphicon glyphicon glyphicon-remove"
													style="color: red;"></i>
											</h:commandLink>
										</div>
									</td>

								</tr>
							</ui:repeat>
						</tbody>
					</table>
				</div>
				<div style="text-align: center;">
					<p:commandLink value="&lt; anterior" styleClass="btn btn-primary"
						rendered="#{listFactory.pagAlerta.pageIndex != 1}"
						action="#{listFactory.pagAlerta.prev}" update="tableAlerta" />
					<p:spacer width="3%" />
					<h:outputText rendered="#{listFactory.pagAlerta.pages &gt; 1}"
						value="#{listFactory.pagAlerta.pageIndex} / #{listFactory.pagAlerta.pages}" />
					<p:spacer width="3%" />
					<p:commandLink value="next &gt;" styleClass="btn btn-primary"
						rendered="#{listFactory.pagAlerta.pageIndex &lt; listFactory.pagAlerta.pages}"
						action="#{listFactory.pagAlerta.next}" update="tableAlerta" />
					<h:inputHidden value="#{listFactory.pagAlerta.pageIndex}" />
				</div>
			</p:outputPanel>

		</h:form>

	</ui:define>
</ui:composition>

</html>
